asyncapi: 2.6.0
info:
  title: SaaS SmartHouse Async API
  description: Provides topics and messages structure
  version: 1.0.0
servers:
  production:
    url: https://localhost:8082
    protocol: RabbitMq
channels:
  command-to-ext-device:
    description: Channel for publishing commands for external device
    publish:
      summary: Publish command
      message:
        contentType: application/json
        $ref: '#/components/messages/SwitchOffDeviceCommand'
  telemetry-device-state:
    description: Channel for publishing state of external device
    publish:
      summary: Publish state
      message:
        contentType: application/json
        $ref: '#/components/messages/ExternalDeviceState'
  telemetry-measurement:
    description: Channel for publishing measurements of external device
    publish:
      summary: Publish measurement
      message:
        contentType: application/json
        $ref: '#/components/messages/ExternalDeviceMeasurement'
components:
  messages:
    SwitchOffDeviceCommand:
      payload:
        type: object
        properties:
          device_serial_number:
            type: integer
            example: 3481097512
          device_type_id:
            type: integer
            example: 1
          data:
            type: object
            properties:
              command:
                type: string
                example: 'off'
              initial_command_log_id:
                type: integer
                example: 1000
    ExternalDeviceState:
      payload:
        type: object
        properties:
          device_serial_number:
            type: integer
            example: 3481097512
          data:
            type: object
            properties:
              state:
                type: string
                example: 'off'
              initial_command_log_id:
                type: integer
                example: 1000
              datetime:
                type: string
                example: '2025-09-01T17:31:19'
    ExternalDeviceMeasurement:
      payload:
        type: object
        properties:
          device_serial_number:
            type: integer
            example: 55554444
          data:
            type: object
            properties:
              value:
                type: string
                example: '23.5'
              unit:
                type: string
                example: 'C'
              datetime:
                type: string
                example: '2025-09-01T16:30:19'

    
